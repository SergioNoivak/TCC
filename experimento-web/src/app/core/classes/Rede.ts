export class Rede{
  grafo:Array<any>;
  p:number
  tamanhoReticulado:number;
  configuracaoInicial:Array<number>;
  tamanhoRegra:number;
  regra:any;
  tamanhoVizinhanca:number;
  estadoAtual:Array<number>;
  vetoresDiagrama:Array<any>;
  espacosDeTempo:number;
  constructor(tamanhoReticulado:number,tamanhoRegra:number,espacosDeTempo:number,p:number,configuracaoInicial?:Array<number>,isFixa?:boolean,numeroRede?:number){
    this.p = p
    this.espacosDeTempo = espacosDeTempo;
    this.tamanhoReticulado = tamanhoReticulado;
    this.configuracaoInicial = configuracaoInicial
    this.tamanhoRegra = tamanhoRegra;
    this.tamanhoVizinhanca = 3
    this.regra = this.dec2bin(this.tamanhoRegra,this.tamanhoVizinhanca)
    this.estadoAtual = this.configuracaoInicial;
    this.criarSmallWorld(isFixa,numeroRede)
    this.vetoresDiagrama = new Array(0)
    this.vetoresDiagrama.push(this.estadoAtual)

    for (let i = 0; i < this.espacosDeTempo; i++) {
      this.estadoAtual = this.evoluir(this.estadoAtual)
      this.vetoresDiagrama.push(this.estadoAtual)
    }





}
evoluir(estadoAtual){
  let n = estadoAtual.length;
  let proximoEstado = new Array(this.tamanhoReticulado)
  for (let i = 0; i < n; i++) {

    let esq = this.grafo[i][0]
    let dir = this.grafo[i][1]
    let pontoDeRegra =""+estadoAtual[esq]+""+estadoAtual[i]+""+estadoAtual[dir];
    let indice = this.bin2dec(pontoDeRegra);
    proximoEstado[i] = +this.regra[indice]
  }
  return proximoEstado;
}
exibir():void{
  console.log("Tamanho: "+this.tamanhoReticulado);
  console.log("Inicio: "+this.configuracaoInicial)



}

dec2bin(dec,tamanho){
  let regraEmBinario =  (dec >>> 0).toString(2);

  let regra = new Array(Math.pow(2,tamanho))

  let k = regraEmBinario.length-1;

  for (let i = regra.length-1; i >= 0; i--) {
    if(k>=0){
      regra[i] = regraEmBinario[k]
      k--;
    }
    else
      regra[i] = 0;
  }
  return regra;
}
bin2dec(num) {
let dec = 0;
for (let i = 0; i < num.length; i++) {
    if (num[num.length - (i + 1)] === '1') {
        dec += 2 ** i;
    }
}
return dec;
}


aleatorizar(){
  let n = this.grafo.length
  for (let i = 0; i < n; i++) {
    for (let j = 0; j < this.grafo[i].length; j++) {
      let numAleatorio = Math.random()
      if(numAleatorio<this.p){
        let sorteioNovoNo = Math.floor((this.grafo.length-1) * Math.random());
        while(sorteioNovoNo==this.grafo[i][j])
           sorteioNovoNo = Math.floor((this.grafo.length-1) * Math.random());

         this.grafo[i][j]= sorteioNovoNo

      }

    }

  }



}

conectarTodosOsNos(){
  let n = this.grafo.length
  for (let i = 0; i < n; i++) {
    let esq = ((i-1) % n + n) % n
    let dir = ((i+1) % n + n) % n
    this.grafo[i].push(esq,dir)
  }
}

criarSmallWorld(isFixa?:boolean,numeroRede?:number){

  if(!isFixa){
    this.grafo = []
    for (let index = 0; index < this.tamanhoReticulado; index++)
       this.grafo.push(new Array());
    this.conectarTodosOsNos();
    this.aleatorizar()


  }
  else {

    switch (numeroRede) {
      case 1:
        this.grafo = grafo1
        break;

      case 2:
        this.grafo = grafo2
        break;

      case 3:
        this.grafo = grafo3
        break;

      case 4:
        this.grafo = grafo4
        break;

      default:
        break;
    }

  }
}

}


let grafo1 =[
  [0, 1],
  [0, 99],
  [1, 2],
  [1, 0],
  [2, 3],
  [2, 1],
  [3, 4],
  [3, 2],
  [4, 5],
  [4, 3],
  [5, 6],
  [5, 4],
  [6, 7],
  [6, 44],
  [7, 8],
  [7, 6],
  [8, 9],
  [8, 7],
  [9, 10],
  [9, 8],
  [10, 11],
  [10, 9],
  [11, 12],
  [11, 10],
  [12, 13],
  [12, 11],
  [13, 14],
  [13, 12],
  [14, 13],
  [14, 67],
  [15, 16],
  [15, 14],
  [16, 17],
  [16, 15],
  [17, 18],
  [17, 16],
  [18, 19],
  [18, 17],
  [19, 20],
  [19, 18],
  [20, 21],
  [20, 19],
  [21, 22],
  [21, 20],
  [22, 23],
  [22, 21],
  [23, 24],
  [23, 22],
  [24, 25],
  [24, 23],
  [25, 26],
  [25, 24],
  [26, 27],
  [26, 25],
  [27, 28],
  [27, 26],
  [28, 29],
  [28, 27],
  [29, 30],
  [29, 28],
  [30, 31],
  [30, 29],
  [31, 32],
  [31, 30],
  [32, 33],
  [32, 31],
  [33, 34],
  [33, 39],
  [34, 35],
  [34, 33],
  [35, 34],
  [35, 20],
  [36, 37],
  [36, 35],
  [37, 38],
  [37, 36],
  [38, 37],
  [38, 45],
  [39, 40],
  [39, 38],
  [40, 41],
  [40, 39],
  [41, 42],
  [41, 40],
  [42, 43],
  [42, 41],
  [43, 44],
  [43, 42],
  [44, 45],
  [44, 43],
  [45, 46],
  [45, 44],
  [46, 47],
  [46, 45],
  [47, 48],
  [47, 46],
  [48, 49],
  [48, 47],
  [49, 50],
  [49, 48],
  [50, 51],
  [50, 49],
  [51, 52],
  [51, 50],
  [52, 53],
  [52, 51],
  [53, 54],
  [53, 1],
  [54, 55],
  [54, 53],
  [55, 56],
  [55, 54],
  [56, 57],
  [56, 78],
  [57, 58],
  [57, 56],
  [58, 59],
  [58, 57],
  [59, 60],
  [59, 58],
  [60, 61],
  [60, 59],
  [61, 62],
  [61, 60],
  [62, 63],
  [62, 61],
  [63, 64],
  [63, 62],
  [64, 65],
  [64, 63],
  [65, 66],
  [65, 64],
  [66, 67],
  [66, 65],
  [67, 68],
  [67, 66],
  [68, 69],
  [68, 67],
  [69, 70],
  [69, 68],
  [70, 71],
  [70, 69],
  [71, 72],
  [71, 70],
  [72, 73],
  [72, 71],
  [73, 74],
  [73, 87],
  [74, 75],
  [74, 73],
  [75, 76],
  [75, 74],
  [76, 77],
  [76, 75],
  [77, 78],
  [77, 70],
  [78, 79],
  [78, 77],
  [79, 80],
  [79, 78],
  [80, 81],
  [80, 79],
  [81, 82],
  [81, 80],
  [82, 83],
  [82, 81],
  [83, 84],
  [83, 82],
  [84, 85],
  [84, 83],
  [85, 86],
  [85, 84],
  [86, 87],
  [86, 85],
  [87, 86],
  [87, 70],
  [88, 89],
  [88, 87],
  [89, 90],
  [89, 88],
  [90, 91],
  [90, 89],
  [91, 92],
  [91, 90],
  [92, 93],
  [92, 37],
  [93, 94],
  [93, 92],
  [94, 93],
  [94, 53],
  [95, 96],
  [95, 94],
  [96, 95],
  [96, 17],
  [97, 96],
  [97, 99],
  [98, 99],
  [98, 97],
  [99, 0],
  [99, 98]
  ]
  
// let grafo1 =[
//   [0, 1],
//   [0, 99],
//   [1, 2],
//   [1, 0],
//   [2, 3],
//   [2, 73],
//   [3, 2],
//   [3, 25],
//   [4, 5],
//   [4, 3],
//   [5, 6],
//   [5, 4],
//   [6, 7],
//   [6, 5],
//   [7, 6],
//   [7, 77],
//   [8, 9],
//   [8, 29],
//   [9, 10],
//   [9, 8],
//   [10, 11],
//   [10, 9],
//   [11, 12],
//   [11, 10],
//   [12, 13],
//   [12, 11],
//   [13, 14],
//   [13, 12],
//   [14, 15],
//   [14, 13],
//   [15, 16],
//   [15, 14],
//   [16, 17],
//   [16, 15],
//   [17, 18],
//   [17, 16],
//   [18, 19],
//   [18, 17],
//   [19, 20],
//   [19, 18],
//   [20, 21],
//   [20, 95],
//   [21, 22],
//   [21, 92],
//   [22, 23],
//   [22, 21],
//   [23, 24],
//   [23, 22],
//   [24, 23],
//   [24, 48],
//   [25, 26],
//   [25, 24],
//   [26, 27],
//   [26, 25],
//   [27, 28],
//   [27, 26],
//   [28, 29],
//   [28, 27],
//   [29, 30],
//   [29, 28],
//   [30, 31],
//   [30, 29],
//   [31, 32],
//   [31, 30],
//   [32, 33],
//   [32, 31],
//   [33, 34],
//   [33, 32],
//   [34, 35],
//   [34, 33],
//   [35, 36],
//   [35, 34],
//   [36, 37],
//   [36, 35],
//   [37, 38],
//   [37, 36],
//   [38, 39],
//   [38, 37],
//   [39, 40],
//   [39, 38],
//   [40, 41],
//   [40, 39],
//   [41, 42],
//   [41, 40],
//   [42, 43],
//   [42, 41],
//   [43, 44],
//   [43, 42],
//   [44, 45],
//   [44, 43],
//   [45, 46],
//   [45, 44],
//   [46, 47],
//   [46, 45],
//   [47, 48],
//   [47, 46],
//   [48, 49],
//   [48, 47],
//   [49, 50],
//   [49, 48],
//   [50, 51],
//   [50, 49],
//   [51, 50],
//   [51, 97],
//   [52, 53],
//   [52, 51],
//   [53, 54],
//   [53, 52],
//   [54, 55],
//   [54, 53],
//   [55, 56],
//   [55, 54],
//   [56, 57],
//   [56, 55],
//   [57, 58],
//   [57, 56],
//   [58, 59],
//   [58, 57],
//   [59, 60],
//   [59, 58],
//   [60, 61],
//   [60, 59],
//   [61, 62],
//   [61, 60],
//   [62, 63],
//   [62, 61],
//   [63, 62],
//   [63, 20],
//   [64, 65],
//   [64, 63],
//   [65, 66],
//   [65, 64],
//   [66, 65],
//   [66, 35],
//   [67, 68],
//   [67, 66],
//   [68, 69],
//   [68, 22],
//   [69, 70],
//   [69, 1],
//   [70, 71],
//   [70, 69],
//   [71, 72],
//   [71, 70],
//   [72, 73],
//   [72, 71],
//   [73, 74],
//   [73, 72],
//   [74, 73],
//   [74, 77],
//   [75, 76],
//   [75, 74],
//   [76, 77],
//   [76, 75],
//   [77, 78],
//   [77, 76],
//   [78, 79],
//   [78, 77],
//   [79, 78],
//   [79, 85],
//   [80, 81],
//   [80, 79],
//   [81, 82],
//   [81, 80],
//   [82, 83],
//   [82, 81],
//   [83, 82],
//   [83, 14],
//   [84, 85],
//   [84, 83],
//   [85, 86],
//   [85, 84],
//   [86, 87],
//   [86, 85],
//   [87, 88],
//   [87, 86],
//   [88, 89],
//   [88, 87],
//   [89, 90],
//   [89, 88],
//   [90, 91],
//   [90, 89],
//   [91, 92],
//   [91, 90],
//   [92, 93],
//   [92, 91],
//   [93, 94],
//   [93, 92],
//   [94, 95],
//   [94, 93],
//   [95, 96],
//   [95, 94],
//   [96, 97],
//   [96, 95],
//   [97, 96],
//   [97, 7],
//   [98, 99],
//   [98, 97],
//   [99, 0],
//   [99, 98]
//   ]
  
  
let grafo2 =  [
  [0, 1],
  [0, 99],
  [1, 2],
  [1, 0],
  [2, 3],
  [2, 1],
  [3, 4],
  [3, 2],
  [4, 5],
  [4, 3],
  [5, 6],
  [5, 4],
  [6, 7],
  [6, 5],
  [7, 8],
  [7, 6],
  [8, 9],
  [8, 7],
  [9, 10],
  [9, 8],
  [10, 11],
  [10, 9],
  [11, 12],
  [11, 10],
  [12, 13],
  [12, 11],
  [13, 14],
  [13, 12],
  [14, 15],
  [14, 13],
  [15, 16],
  [15, 14],
  [16, 17],
  [16, 15],
  [17, 18],
  [17, 16],
  [18, 19],
  [18, 17],
  [19, 20],
  [19, 18],
  [20, 21],
  [20, 19],
  [21, 22],
  [21, 20],
  [22, 23],
  [22, 21],
  [23, 24],
  [23, 22],
  [24, 25],
  [24, 23],
  [25, 26],
  [25, 24],
  [26, 27],
  [26, 25],
  [27, 28],
  [27, 26],
  [28, 29],
  [28, 27],
  [29, 30],
  [29, 28],
  [30, 31],
  [30, 29],
  [31, 32],
  [31, 30],
  [32, 33],
  [32, 31],
  [33, 34],
  [33, 32],
  [34, 35],
  [34, 33],
  [35, 36],
  [35, 34],
  [36, 37],
  [36, 35],
  [37, 38],
  [37, 36],
  [38, 39],
  [38, 37],
  [39, 40],
  [39, 38],
  [40, 41],
  [40, 39],
  [41, 42],
  [41, 40],
  [42, 43],
  [42, 41],
  [43, 44],
  [43, 42],
  [44, 45],
  [44, 43],
  [45, 46],
  [45, 44],
  [46, 47],
  [46, 45],
  [47, 48],
  [47, 46],
  [48, 49],
  [48, 47],
  [49, 50],
  [49, 48],
  [50, 51],
  [50, 49],
  [51, 52],
  [51, 50],
  [52, 53],
  [52, 51],
  [53, 54],
  [53, 52],
  [54, 55],
  [54, 53],
  [55, 56],
  [55, 54],
  [56, 57],
  [56, 55],
  [57, 58],
  [57, 56],
  [58, 59],
  [58, 57],
  [59, 60],
  [59, 58],
  [60, 61],
  [60, 59],
  [61, 62],
  [61, 60],
  [62, 63],
  [62, 61],
  [63, 64],
  [63, 62],
  [64, 65],
  [64, 63],
  [65, 66],
  [65, 64],
  [66, 67],
  [66, 65],
  [67, 68],
  [67, 66],
  [68, 69],
  [68, 67],
  [69, 70],
  [69, 68],
  [70, 71],
  [70, 69],
  [71, 72],
  [71, 70],
  [72, 73],
  [72, 71],
  [73, 74],
  [73, 72],
  [74, 75],
  [74, 73],
  [75, 76],
  [75, 74],
  [76, 77],
  [76, 75],
  [77, 78],
  [77, 76],
  [78, 79],
  [78, 77],
  [79, 80],
  [79, 78],
  [80, 81],
  [80, 79],
  [81, 82],
  [81, 80],
  [82, 83],
  [82, 81],
  [83, 84],
  [83, 82],
  [84, 83],
  [84, 89],
  [85, 86],
  [85, 84],
  [86, 87],
  [86, 85],
  [87, 88],
  [87, 86],
  [88, 89],
  [88, 87],
  [89, 90],
  [89, 88],
  [90, 91],
  [90, 89],
  [91, 92],
  [91, 90],
  [92, 93],
  [92, 91],
  [93, 94],
  [93, 92],
  [94, 95],
  [94, 93],
  [95, 96],
  [95, 94],
  [96, 97],
  [96, 95],
  [97, 98],
  [97, 96],
  [98, 99],
  [98, 97],
  [99, 0],
  [99, 98]
  ]
  

let grafo3 = [
  [0, 1],
  [0, 99],
  [1, 2],
  [1, 0],
  [2, 3],
  [2, 1],
  [3, 4],
  [3, 2],
  [4, 5],
  [4, 3],
  [5, 6],
  [5, 4],
  [6, 7],
  [6, 5],
  [7, 8],
  [7, 6],
  [8, 9],
  [8, 7],
  [9, 10],
  [9, 8],
  [10, 11],
  [10, 9],
  [11, 12],
  [11, 10],
  [12, 13],
  [12, 11],
  [13, 14],
  [13, 12],
  [14, 15],
  [14, 13],
  [15, 16],
  [15, 14],
  [16, 17],
  [16, 15],
  [17, 18],
  [17, 16],
  [18, 19],
  [18, 17],
  [19, 20],
  [19, 18],
  [20, 21],
  [20, 19],
  [21, 22],
  [21, 20],
  [22, 23],
  [22, 21],
  [23, 24],
  [23, 22],
  [24, 25],
  [24, 23],
  [25, 26],
  [25, 24],
  [26, 27],
  [26, 25],
  [27, 28],
  [27, 26],
  [28, 29],
  [28, 27],
  [29, 30],
  [29, 28],
  [30, 31],
  [30, 29],
  [31, 32],
  [31, 30],
  [32, 33],
  [32, 31],
  [33, 34],
  [33, 32],
  [34, 35],
  [34, 33],
  [35, 36],
  [35, 34],
  [36, 37],
  [36, 35],
  [37, 38],
  [37, 36],
  [38, 39],
  [38, 37],
  [39, 40],
  [39, 38],
  [40, 41],
  [40, 39],
  [41, 42],
  [41, 40],
  [42, 43],
  [42, 41],
  [43, 44],
  [43, 42],
  [44, 45],
  [44, 43],
  [45, 46],
  [45, 44],
  [46, 47],
  [46, 45],
  [47, 48],
  [47, 46],
  [48, 49],
  [48, 47],
  [49, 50],
  [49, 48],
  [50, 51],
  [50, 49],
  [51, 52],
  [51, 50],
  [52, 51],
  [52, 66],
  [53, 54],
  [53, 52],
  [54, 55],
  [54, 53],
  [55, 56],
  [55, 54],
  [56, 57],
  [56, 55],
  [57, 58],
  [57, 56],
  [58, 59],
  [58, 57],
  [59, 60],
  [59, 58],
  [60, 61],
  [60, 59],
  [61, 62],
  [61, 60],
  [62, 63],
  [62, 61],
  [63, 64],
  [63, 62],
  [64, 65],
  [64, 63],
  [65, 66],
  [65, 64],
  [66, 67],
  [66, 65],
  [67, 68],
  [67, 66],
  [68, 69],
  [68, 67],
  [69, 70],
  [69, 68],
  [70, 71],
  [70, 69],
  [71, 72],
  [71, 70],
  [72, 73],
  [72, 71],
  [73, 74],
  [73, 72],
  [74, 75],
  [74, 73],
  [75, 76],
  [75, 74],
  [76, 77],
  [76, 75],
  [77, 78],
  [77, 76],
  [78, 79],
  [78, 77],
  [79, 80],
  [79, 78],
  [80, 81],
  [80, 79],
  [81, 82],
  [81, 80],
  [82, 83],
  [82, 81],
  [83, 84],
  [83, 82],
  [84, 85],
  [84, 83],
  [85, 86],
  [85, 84],
  [86, 87],
  [86, 85],
  [87, 88],
  [87, 86],
  [88, 89],
  [88, 87],
  [89, 90],
  [89, 88],
  [90, 91],
  [90, 89],
  [91, 92],
  [91, 90],
  [92, 93],
  [92, 91],
  [93, 94],
  [93, 92],
  [94, 95],
  [94, 93],
  [95, 96],
  [95, 94],
  [96, 97],
  [96, 95],
  [97, 98],
  [97, 96],
  [98, 99],
  [98, 97],
  [99, 0],
  [99, 98]
  ]
  
let grafo4 =[
  [0, 1],
  [0, 99],
  [1, 2],
  [1, 0],
  [2, 3],
  [2, 1],
  [3, 4],
  [3, 2],
  [4, 5],
  [4, 3],
  [5, 6],
  [5, 4],
  [6, 7],
  [6, 5],
  [7, 8],
  [7, 6],
  [8, 9],
  [8, 7],
  [9, 10],
  [9, 8],
  [10, 11],
  [10, 9],
  [11, 12],
  [11, 10],
  [12, 13],
  [12, 11],
  [13, 14],
  [13, 12],
  [14, 15],
  [14, 13],
  [15, 16],
  [15, 14],
  [16, 17],
  [16, 15],
  [17, 18],
  [17, 16],
  [18, 19],
  [18, 17],
  [19, 20],
  [19, 18],
  [20, 21],
  [20, 19],
  [21, 22],
  [21, 20],
  [22, 23],
  [22, 21],
  [23, 24],
  [23, 22],
  [24, 25],
  [24, 23],
  [25, 26],
  [25, 24],
  [26, 27],
  [26, 25],
  [27, 28],
  [27, 26],
  [28, 29],
  [28, 27],
  [29, 30],
  [29, 28],
  [30, 31],
  [30, 29],
  [31, 32],
  [31, 30],
  [32, 33],
  [32, 31],
  [33, 34],
  [33, 32],
  [34, 35],
  [34, 33],
  [35, 36],
  [35, 34],
  [36, 37],
  [36, 35],
  [37, 38],
  [37, 36],
  [38, 37],
  [38, 23],
  [39, 40],
  [39, 38],
  [40, 41],
  [40, 39],
  [41, 42],
  [41, 40],
  [42, 43],
  [42, 41],
  [43, 44],
  [43, 42],
  [44, 45],
  [44, 43],
  [45, 46],
  [45, 44],
  [46, 47],
  [46, 45],
  [47, 48],
  [47, 46],
  [48, 49],
  [48, 47],
  [49, 50],
  [49, 48],
  [50, 51],
  [50, 49],
  [51, 52],
  [51, 50],
  [52, 53],
  [52, 51],
  [53, 54],
  [53, 52],
  [54, 55],
  [54, 53],
  [55, 56],
  [55, 54],
  [56, 57],
  [56, 55],
  [57, 58],
  [57, 56],
  [58, 59],
  [58, 57],
  [59, 60],
  [59, 58],
  [60, 61],
  [60, 59],
  [61, 62],
  [61, 60],
  [62, 63],
  [62, 61],
  [63, 64],
  [63, 62],
  [64, 65],
  [64, 63],
  [65, 66],
  [65, 64],
  [66, 67],
  [66, 65],
  [67, 66],
  [67, 78],
  [68, 69],
  [68, 67],
  [69, 70],
  [69, 68],
  [70, 71],
  [70, 69],
  [71, 72],
  [71, 70],
  [72, 73],
  [72, 71],
  [73, 74],
  [73, 72],
  [74, 75],
  [74, 73],
  [75, 76],
  [75, 74],
  [76, 77],
  [76, 75],
  [77, 78],
  [77, 76],
  [78, 79],
  [78, 77],
  [79, 80],
  [79, 78],
  [80, 81],
  [80, 79],
  [81, 82],
  [81, 80],
  [82, 83],
  [82, 81],
  [83, 84],
  [83, 82],
  [84, 85],
  [84, 83],
  [85, 86],
  [85, 84],
  [86, 87],
  [86, 85],
  [87, 88],
  [87, 86],
  [88, 89],
  [88, 87],
  [89, 90],
  [89, 88],
  [90, 91],
  [90, 89],
  [91, 92],
  [91, 90],
  [92, 93],
  [92, 91],
  [93, 94],
  [93, 79],
  [94, 95],
  [94, 93],
  [95, 96],
  [95, 94],
  [96, 97],
  [96, 95],
  [97, 98],
  [97, 96],
  [98, 99],
  [98, 97],
  [99, 0],
  [99, 98]
  ]
  